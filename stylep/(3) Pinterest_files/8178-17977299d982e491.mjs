(self.modernJsonp=self.modernJsonp||[]).push([["8178"],{458345(e,t,i){i.d(t,{A:()=>u});var n=i(679902),r=i(432321),a=i(427471),s=i(435108),o=i(457315),l=i(81920),d=i(676692),c=i(121066),p=i(399952);let u=function(){let e=(0,r.A)();if(e?.isAuthenticated&&!function(){let e=(0,r.A)(),t=window.location.pathname.startsWith("/settings/notifications"),i=window.location.pathname.startsWith("/reports-and-violations/"),n=window.location.pathname.startsWith("/email/subscription")||window.location.pathname.startsWith("/email/remove")||t,a=window.location.pathname.startsWith("/pin/create/"),s="/pin-builder/"===window.location.pathname&&/url=/.test(window.location.href),{userAgent:o}=e||{userAgent:{isMobile:!1,isTablet:!1}};return o.isMobile||o.isTablet?n||i:a||s||n||i}()){let{viewType:t,viewParameter:i}=(0,d.Cs)()??{},r=(0,c.uy)(window),u=e.experimentsClient.checkExperiment("web_metrics_retry_count").anyEnabled;!function(e,t,i=!1){if(i){let i=0,n=3e4,r=()=>{a.A.create("ActiveUserResource",e).callCreate().catch(a=>{let d,c=a.message;if(c&&"object"==typeof c){"_t_message"in c&&delete c._t_message;try{d=JSON.stringify(c)}catch(e){d="Unable to serialize error message"}}else d=c;(0,l.GV)("webapp.metrics.dau.errors",{sampleRate:1,tags:{message:d,browser:e.data.browser,error_code:(0,o.A)(a,"api_error_code")||"unknown",is_auth:t}}),setTimeout(()=>{n>s.Qv||(n*=2,i+=1,e.data.auxData.event_retry_count=i,r())},n)})};r()}else{let i=a.A.create("ActiveUserResource",e),n=3e4;i.callCreate().catch(r=>{let a,d=r.message;if(d&&"object"==typeof d){"_t_message"in d&&delete d._t_message;try{a=JSON.stringify(d)}catch(e){a="Unable to serialize error message"}}else a=d;(0,l.GV)("webapp.metrics.dau.errors",{sampleRate:1,tags:{message:a,browser:e.data.browser,error_code:(0,o.A)(r,"api_error_code")||"unknown",is_auth:t}}),setTimeout(()=>{n>s.Qv||(n*=2,i.callCreate())},n)})}}({data:{appVersion:(0,p.A)(),auxData:{pwa_type:r&&"unknown"!==r?r:void 0,stage:e.stage??"unknown"},browser:e.userAgent.browserType,clientUUID:(0,n.A)(),event_type:7137,time:1e6*Date.now(),unauth_id:e.unauthId,view_type:t,view_parameter:i}},e.isAuthenticated,u)}}},131321(e,t,i){i.d(t,{A:()=>n});function n(e,t){return t in e}},805863(e,t,i){i.d(t,{A:()=>a});var n=i(457315),r=i(752159);function a(){let e=navigator.serviceWorker;return e&&e.getRegistration?((0,r.PM)("mweb_service_worker.unregister_attempt"),e.getRegistration().then(e=>{if(e)return e.unregister().then(()=>((0,r.PM)("mweb_service_worker.unregister_success"),navigator.serviceWorker&&window.caches?window.caches.keys().then(e=>{let t=e.find(e=>e.startsWith("workbox-precaching"));return t?window.caches.delete(t):null}).then(()=>(0,r.PM)("mweb_service_worker.clear_app_shell")):Promise.resolve())).catch(e=>{(0,r.fu)("mweb_service_worker.unregister_fail",{error:(0,n.A)(e,"message")})})})):Promise.resolve()}},385800(e,t,i){i.d(t,{A:()=>s,e:()=>a});var n=i(859471);let r=()=>{let[e,t]=(0,n.useState)(!1),[i,r]=(0,n.useState)(!1),[a,s]=(0,n.useState)(!1);return{active:e,focused:i,hovered:a,onBlur:()=>{r(!1),t(!1)},onFocus:()=>r(!0),onMouseDown:()=>t(!0),onMouseEnter:()=>s(!0),onMouseLeave:()=>{s(!1),t(!1)},onMouseUp:()=>t(!1)}};function a({children:e}){return e(r())}let s=r},57454(e,t,i){i.d(t,{A:()=>eG});var n=i(61163),r=i(859471),a=i(106386),s=i(979638),o=i(963522),l=i(706114),d=i(458345),c=i(668014),p=i(296221),u=i(358203),h=i(586733),_=i(671996),m=i(678863),f=i(845126),x=i(642883),b=i(201593);let g={borderRadius:"32px 32px 0px 0px",bottom:0,left:0,overflow:"hidden",touchAction:"none",boxShadow:"0px 0px 8px rgba(0, 0, 0, 0.1)",zIndex:1,width:"100vw",maxHeight:"100vw",minHeight:"30vh"},w={full:"100vh",default:"50vh",auto:""},y=({size:e,isDarkMode:t})=>(g.height=w[e],g.maxHeight="auto"===e?"90vh":"100vw",g.backgroundColor=t?b.be:"#FFFFFF",g);var A=i(995273),v=i(538329),P=i(911127),j=i(826258),S=i(562615);let I=({content:e,footer:t,header:i})=>{let[n,a]=(0,r.useState)(!1),s=(0,r.useRef)(null),l=(0,r.useCallback)(()=>{let e=s.current;e&&a(e?.clientHeight<e?.scrollHeight&&e.offsetHeight+e.scrollTop<e.scrollHeight)},[]);return(0,r.useEffect)(()=>{l()},[l]),(0,r.useEffect)(()=>(window?.addEventListener("resize",l),()=>{window?.removeEventListener("resize",l)}),[l]),(0,S.jsxs)(r.Fragment,{children:[(0,S.jsxs)(o.az,{ref:s,fit:!0,onScroll:l,overflow:"scroll",padding:0,children:[i,(0,S.jsx)(o.az,{flex:"grow",overflow:"auto",children:e})]}),!!t&&(0,S.jsx)(o.az,{dangerouslySetInlineStyle:n?{__style:{boxShadow:"var(--sema-space-0) var(--sema-space-negative-50) var(--sema-space-200) var(--sema-space-0) rgb(0 0 0 / 0.12)"}}:void 0,fit:!0,position:"relative",children:t})]})};function T({accessibilityModalLabel:e,allowClickAndDrag:t,allowBackgroundScroll:i=!1,children:a,closeOnOutsideClick:s=!0,footer:l,header:d,isOpen:c,mobileIsSlideUp:p,onDismiss:u,zIndex:h,size:_="auto"}){(0,r.useEffect)(()=>{(0,n.A)("SheetMobileWithMediaHeader","/app/packages/experiences/gestalt/SheetMobile/SheetMobileWithMediaHeader.tsx")},[]);let m=(0,v.A)(),f=(0,r.useRef)(null),{setAppFocusState:g}=(0,j.Y)(),[T,k]=(0,r.useState)(!1),{isDarkMode:z}=(0,b.D2)();if((0,r.useEffect)(()=>(c?g(!1):g(!0),()=>{c&&g(!0)}),[g,c]),(0,r.useEffect)(()=>(f.current=(0,x.A)(()=>{f.current&&k(!0)}),()=>{"u">typeof window&&Object.prototype.hasOwnProperty.call(window,"cancelAnimationFrame")&&f.current&&(window.cancelAnimationFrame(f.current),f.current=null)}),[]),(0,r.useEffect)(()=>{let e=c&&!i;return e&&(()=>{if(document.body){let{body:{style:e}}=document;e.overflow="hidden",e.touchAction="none"}})(),()=>{e&&(()=>{if(document.body){let{body:{style:e}}=document;e.overflow="visible",e.touchAction="auto"}})()}},[c,i]),!c)return null;let E=(({isDarkMode:e,size:t})=>{let i=e?b.be:"#FFFFFF";return{__style:{...y({size:t,isDarkMode:e}),backgroundColor:i,transitionProperty:"transform, opacity",transitionTimingFunction:"ease-out"}}})({isDarkMode:z,size:_});E.__style.transform=(()=>{if(p||!(()=>{if("u"<typeof window)return!1;let e=Math.max(window.visualViewport?.width||0,window.innerWidth,document.documentElement.clientWidth),t=Math.max(window.visualViewport?.height||0,window.innerHeight,document.documentElement.clientHeight);return e<=380||t<=760})())return"";let e=Math.min(1,(Math.max(window.visualViewport?.width||0,window.innerWidth,document.documentElement.clientWidth)-12)/380,(Math.max(window.visualViewport?.height||0,window.innerHeight,document.documentElement.clientHeight)-12)/600);return e=Math.max(.8,e),` scale(${e})`})();let H=(({size:e,isShowing:t,isDarkMode:i})=>{let n=y({size:e,isDarkMode:i});return n.transition="all 225ms cubic-bezier(0.0,0.0,0.2,1) 500ms",n.transform=t?"translateY(0)":`translateY(${w[e]||"100vh"})`,{__style:n}})({size:_,isShowing:T,isDarkMode:z});return(0,S.jsx)(P.A,{allowClickAndDrag:t,children:(0,S.jsx)(o.Wd,{children:(0,S.jsxs)(o.az,{"aria-label":e,display:"inlineBlock",height:"100%",position:"relative",role:"dialog",zIndex:h||A.QN,children:[(0,S.jsx)(o.Rp,{accessibilityLabel:m._('Mobile Sheet Mask', 'mweb.sheet_mobile.mask', 'The accessibility label for the mask of mobile sheet'),onTap:()=>{s&&u()},tapStyle:"none",children:(0,S.jsx)(o.az,{dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(0, 0, 0, .5)",touchAction:"none",transitionProperty:"opacity",transitionTimingFunction:"ease-out"}},height:"100%",left:!0,position:"fixed",top:!0,width:"100%",zIndex:new o.rk(1)})}),(0,S.jsx)(o.az,{color:"default",dangerouslySetInlineStyle:p?H:E,position:"fixed",children:(0,S.jsx)(o.az,{direction:"column",display:"flex",justifyContent:"between",maxHeight:H.__style?.maxHeight||"100vh",position:"relative",width:"100%",children:(0,S.jsx)(I,{content:a,footer:l,header:d})})})]})})})}var k=i(81920);let z=({display_data:e,complete:t,dismiss:i,context_aux_data:n})=>{let a=(0,v.A)(),{logContextEvent:s}=(0,h.o)(),[l,d]=(0,r.useState)(!0),[c,p]=(0,r.useState)(0),u=()=>{d(!1),i()},x=(0,r.useCallback)((e,t)=>{s({event_type:e,component:15489,element:t,aux_data:{experience_id:n.experience_id,placement_id:n.placement_id,step_number:c+1,step_index:c}})},[n.experience_id,n.placement_id,c,s]);if((0,r.useEffect)(()=>{x(13,18257)},[c,x]),!l)return null;if(!(e.steps&&e.steps.length>0&&e.steps.every(e=>e.title&&e.subtitle&&e.primary_button&&e.image)))return(0,k.GV)(_.pv,{sampleRate:1,tags:{experience_id:n.experience_id,placement_id:n.placement_id,reason:"Required display data not present",platform:4}}),null;let b=e.steps[c];if(!b)return(0,k.GV)(_.pv,{sampleRate:1,tags:{experience_id:n.experience_id,placement_id:n.placement_id,reason:`No step for index ${c}`,platform:4}}),null;let g=window?.innerWidth||375,w=(0,S.jsxs)(r.Fragment,{children:[(0,S.jsx)(o.ib,{top:0,children:(0,S.jsx)(o.az,{padding:3,position:"absolute",width:"100%",children:(0,S.jsx)(o.K0,{accessibilityLabel:a._('Dismiss', 'experiences.ExperienceModalWindow.modalDismissIconButton', 'Accessibility label for the X icon button to dismiss the modal window'),bgColor:"washLight",icon:"close",iconColor:"default",onClick:()=>{x(123,75),u()},size:"lg"})})}),(0,S.jsx)(o.iX,{contentAspectRatio:.8,height:1.25*g,width:g,children:(0,S.jsx)(o._V,{alt:b.image.image_alt,color:b.image.dominant_color||void 0,fit:"cover",naturalHeight:b.image.height,naturalWidth:b.image.width,src:b.image.url})})]}),y=(0,S.jsxs)(o.az,{alignItems:"center",display:"flex",flex:"grow",justifyContent:"center",paddingX:2,paddingY:3,children:[b.secondary_button&&(0,S.jsx)(m.A,{buttonType:"secondary",data:(0,f.q)(b.secondary_button,()=>{x(102,13005),u()}),experienceSchema:2}),(0,S.jsx)(m.A,{buttonType:"primary",data:(0,f.q)(b.primary_button,()=>{c<e.steps.length-1?(x(102,13004),p(c+1)):t()}),experienceSchema:2})]});return(0,S.jsx)(T,{accessibilityModalLabel:a._('Multi Step Modal', 'experiences.ExperienceMultiStepModal.accessibilityModalLabel', 'Accessibility label for the multi step modal'),allowClickAndDrag:!1,footer:y,header:w,isOpen:l,mobileIsSlideUp:!0,onDismiss:()=>{x(123,16412),u()},size:"auto",children:(0,S.jsxs)(o.az,{padding:3,children:[(0,S.jsx)(o.az,{marginBottom:3,children:(0,S.jsx)(o._Y,{size:"500",children:b.title})}),(0,S.jsx)(o.KJ,{children:b.subtitle})]})})};function E({experience:e}){return(0,r.useEffect)(()=>{(0,n.A)("ExperienceMultiStepModal","/app/packages/experiences/Experiences/ExperienceMultiStepModal/ExperienceMultiStepModal.tsx")},[]),(0,S.jsx)(p.Je,{eligibleSchemas:[2],eligibleTypes:[26],experience:e,children:({complete:t,dismiss:i,experience:{display_data:n}})=>(0,S.jsx)(z,{complete:t,context_aux_data:{experience_id:e?.experience_id,placement_id:e?.placement_id},dismiss:i,display_data:n})})}var H=i(171768),C=i(777275),M=i(567176),R=i(693154),L=i(303196),D=i(214429),U=i(41206),F=i(601185),O=i(844255),W=i(430705),B=i(618243),N=i(328582),V=i(998556),J=i(319571),Y=i(706466),G=i(803489),q=i(971289),K=i(720575),X=i(807782),Q=i(825179),$=i(439524),Z=i(694804);i(487688);var ee=i(743372),et=i(168079),ei=i(328673);let en={__style:{textOverflow:"ellipsis",whiteSpace:"nowrap"}};function er({currentTabIndex:e,tabBoards:t}){(0,r.useEffect)(()=>{(0,n.A)("MoreIdeasTabs","/app/www/Homefeed/MoreIdeasTabs.tsx")},[]);let i=(0,r.useRef)(null),l=(0,r.useRef)(!1),d=(0,r.useRef)([]),c=(0,s.Zp)(),p=(0,v.A)(),u=(0,ee.A)(),h=(0,a.wA)(),_=t.length?[{href:"/",text:(0,S.jsx)(o.az,{children:p._('All', 'homefeed.moreIdeasTab.homefeedTab', 'Homefeed tab')}),tabType:1},...t.filter(e=>e).map(({id:e,name:t},i)=>({href:`/?boardId=${String(e)}`,text:(0,S.jsx)(o.az,{dangerouslySetInlineStyle:en,maxWidth:100,overflow:"hidden",children:t}),boardId:e,tabType:2,ref:d.current[i]}))]:null;if((0,et.A)(()=>{d.current=Array(t.length).fill(void 0).map((e,t)=>d.current[t]||(0,r.createRef)())}),(0,r.useEffect)(()=>()=>{l.current&&(window.cancelAnimationFrame(l.current),l.current=null)}),!_)return null;let m=_.map(e=>({href:e.href,text:e.text,ref:e.ref}));return(0,S.jsx)(o.az,{ref:i,"data-test-id":"more-ideas-tabs",fit:!0,marginBottom:1,marginTop:1,overflow:"scrollX",children:(0,S.jsx)(o.tU,{activeTabIndex:e,onChange:({activeTabIndex:e})=>{let i=_?.[e];if(i){let n;n=i.boardId,h((0,ei.Y)(n,e));let r=1===i.tabType?p._('All', 'homefeed.moreIdeasTab.homefeedTab', 'Homefeed tab'):t.find(e=>e.id===i.boardId)?.name;u({event_type:101,view_type:1,view_parameter:92,component:13184,element:1===i.tabType?11081:11082,aux_data:{index:e.toString(),board_id:i.boardId,referrer:19,tab_title:r},object_id_str:i.boardId})}let{pathname:n,state:r}=_?{pathname:(_[e]||_[0]).href,state:(_[e]||_[0]).locationState||void 0}:{};c(n,{state:r})},tabs:m})})}var ea=i(765346),es=i(273919),eo=i(863265),el=i(593936),ed=i(242978),ec=i(284247),ep=i(996209),eu=i(809756),eh=i(499053),e_=i(699613);let em=new o.rk(100);function ef({pinUrl:e,inviter:t}){(0,r.useEffect)(()=>{(0,n.A)("NuxSharedPinBanner","/app/www/pages/duplo/NuxSharedPinBanner.tsx")},[]);let i=(0,v.A)(),s=(0,e_.HR)(),[l,d]=(0,r.useState)(!0),c=(0,a.wA)(),p=()=>c((0,eh.A)(null,null)),u=(0,ep.A)(e),{data:h}=(0,W.A)({name:"PinResource",options:{id:u,field_set_key:"detailed",is_mobile_fork:!0}}),_=u?s(u):null,m=h??_,f=m?.image_medium_url??m?.image_large_url,x=t.first_name??t.full_name??t.username??"",b=(0,ec.A)(i._('Tell {{ name }} what you think', 'HomePage.SharedPinBannerTitle', 'Shared pin banner title. name: inviter\'s display name'),{name:x}),{navFooterHeight:g}=(0,eu.o)();return u&&m&&x&&f&&l?(0,S.jsx)(o.az,{marginBottom:2,marginTop:2,paddingX:2,children:(0,S.jsx)(o.vF,{message:i._('See what inspired them and reply with your thoughts', 'HomePage.SharedPinBanner.Subtext', 'Subtext for shared pin banner'),offset:{bottom:g+8,top:0},onDismiss:()=>{p(),d(!1)},primaryAction:{href:e+"&hide_app_upsell=true",label:i._('See Pin', 'HomePage.SharedPinToastAction', 'CTA to view shared pin'),accessibilityLabel:i._('See shared Pin', 'HomePage.SharedPinToastAction.accessibilityLabel', 'Accessibility label for CTA to view shared pin'),onClick:p,role:"link"},secondaryAction:{accessibilityLabel:i._('Later', 'HomePage.SharedPinBannerSecondary.accessibilityLabel', 'Dismiss shared pin banner'),label:i._('Later', 'HomePage.SharedPinBannerSecondary', 'Secondary action to dismiss shared pin banner'),onClick:()=>{p(),d(!1)},role:"button"},thumbnail:{image:(0,S.jsx)(o._V,{alt:"Shared Pin",color:"transparent",fit:"cover",naturalHeight:40,naturalWidth:40,src:f})},title:b,zIndex:em})}):null}function ex(){(0,r.useEffect)(()=>{(0,n.A)("PreferencesUpdatedBanner","/app/www/pages/duplo/PreferencesUpdatedBanner.tsx")},[]);let{shouldRefreshHomefeed:e,clearRefreshFlag:t}=(0,el.d)(),{showToast:i}=(0,Y.CG)(),a=(0,v.A)(),s=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{if(e&&!s.current){s.current=!0;let e=a._('Preferences updated! We\'re refreshing your feed now.', 'PreferencesUpdatedBanner.message', 'Message shown when user returns to homefeed after updating preferences');i(({hideToast:i})=>(0,S.jsx)(M.A,{duration:3e3,onHide:()=>{i(),t(),s.current=!1},text:e}))}else e||(s.current=!1)},[e,t,i,a]),null}var eb=i(623987),eg=i(408738);function ew(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let ey=(0,eg.A)(()=>i.e("82269").then(i.bind(i,922453)),void 0,e=>922453,"app-www-pages-duplo-CoreActionsHeader",e=>["82269"]),eA=(0,eg.A)(()=>i.e("65469").then(i.bind(i,497826)),void 0,e=>497826,"app-www-stories-FullWidthPinStory",e=>["65469"]),ev=(0,eg.A)(()=>i.e("11757").then(i.bind(i,50812)),{ssr:!1},e=>50812,void 0,void 0),eP=(0,eg.A)(()=>i.e("30764").then(i.bind(i,907748)),void 0,e=>907748,"app-www-Homefeed-HomefeedMoreIdeasTabContent",e=>["30764"]),ej=(0,eg.A)(()=>i.e("45231").then(i.bind(i,827279)),void 0,e=>827279,"app-www-stories-LandingPageStory-LandingPageStory",e=>["45231"]),eS=(0,eg.A)(()=>Promise.all([i.e("18324"),i.e("46782"),i.e("49412")]).then(i.bind(i,945101)),{ssr:!1},e=>945101,void 0,void 0),eI=(0,eg.A)(()=>Promise.all([i.e("43744"),i.e("99233")]).then(i.bind(i,308344)),{ssr:!1},e=>308344,void 0,void 0),eT=(0,eg.A)(()=>i.e("93920").then(i.bind(i,626531)),{ssr:!1},e=>626531,void 0,void 0),ek=(0,eg.A)(()=>Promise.all([i.e("91796"),i.e("28081")]).then(i.bind(i,668008)),{ssr:!1},e=>668008,void 0,void 0),ez=(0,r.lazy)(()=>i.e("98325").then(i.bind(i,757876))),eE=(0,r.lazy)(()=>i.e("72022").then(i.bind(i,21589))),eH=(0,r.lazy)(()=>i.e("39634").then(i.bind(i,92041))),eC=(0,r.lazy)(()=>i.e("41334").then(i.bind(i,64469))),eM=(0,r.lazy)(()=>i.e("9106").then(i.bind(i,286441))),eR=(0,r.lazy)(()=>i.e("99062").then(i.bind(i,562773))),eL={feedKey:ed.bg,trafficSource:ed.mA,resourceName:ed.jC,feedItemProps:e=>({viewParameter:92,viewType:1,onFeedItemClick:()=>{e.onFeedItemClick&&e.onFeedItemClick()}}),pullToRefresh:!0},eD={first_page_size:"25",page_size:"10"},eU=({webMobileHomeFeedTakoverExperience:e})=>{let{feedKey:t,feedItemProps:i,pullToRefresh:n}=eL,r=(0,s.zy)(),d=(0,s.Zp)(),c=(0,a.d4)(({session:e})=>e.firstHomeFeedRequestAfterNux),p={webMobileHomeFeedTakoverExperience:e,location:r,navigate:d},u=(0,a.d4)(({feeds:e})=>e[t]??[]),{selectedUseCases:h,selectedPins:_}=(0,eo.p)(),m=(0,ea.xx)(h,_),f=!c,x=m.length>0?{in_nux:c,nux_signals_map:m}:{in_nux:c},b={...ed.Vf,...f?{...eD}:{...x},in_local_navigation:!0,static_feed:!!(r&&(r.pathname.includes("pwt_performance_testing")||void 0!==(0,G.A)(r.search).pwt_performance_testing))},g=(0,W.A)({name:ed.jC,options:b}),{isAtEnd:w,isFetching:y,fetchMore:A,data:v,refresh:P}=g,j={includeBackgroundImages:!0,includeVideos:!0,pins:Object.values((0,e_.zy)())};c&&(0,k.GV)("home_product.homefeed.has_in_nux_flag",{sampleRate:.1,tags:{appType:"mweb"}});let I=(()=>{let{isGraphQLEnabledInGeneral:e}=(0,X.aR)(),{locale:t}=(0,O._8)(),i=(0,e_.zy)();return({feedItems:n,prevFeedItems:r,finishedRefresh:a,unauthLandingPinStateForAuthHomefeed:{pinId:s,feedItem:o}})=>{if(!n.length)return null;if(a&&r.length>0){let e=(e,t)=>e.slice(0,t).map(e=>e.id),i=e(r,5),a=e(n,5),s={appType:"mweb",language:t&&t.slice(0,2)||"unknown",locale:t||"unknown"};(0,k.GV)("home_product.homefeed.refresh",{sampleRate:1,tags:s}),JSON.stringify(i)===JSON.stringify(a)&&(0,k.GV)("home_product.homefeed.refresh.no_change",{sampleRate:1,tags:s})}if(s&&!e){if(r.length>0&&r[0]!==n[0])return(0,V.y1)().removeItem(l.sH),{feedItem:null,pinId:null};else if((0===r.length||r[0]===n[0]&&r.length!==n.length||!o)&&i[s]&&!n.slice(0,5).some(({id:e})=>e===s))return{feedItem:{id:s,type:"pin",trackingParams:n[0].trackingParams},pinId:s}}return null}})(),T=v?.length?v[0]:null;if(e&&e.display_data?.in_checklist_education&&e.display_data?.num_columns_requested===2){let e={type:"fullWidthBreakIn",value:{index:0,content:T?.id&&(0,S.jsx)(eb.A,{storyId:T.id,children:e=>(0,S.jsx)(eA,{slotIndex:0,story:e,viewParameter:3833,viewType:604})})}},r=u.slice(1);return(0,S.jsx)(o.az,{"data-test-id":"homefeed",children:(0,S.jsx)(Q.RM,{authHomefeedComponentDidUpdate:I,feedItemProps:i&&i(p),feedItems:r,feedItemsAdjustment:e,feedKey:t,pagination:{hasNext:!w,isLoadingNext:y,loadNext:()=>A(),refetch:()=>P()},pullToRefresh:n,trafficSource:ed.mA,visuallyCompleteProfilerOptions:j})})}return f&&!e?.display_data?(0,S.jsx)(o.az,{"data-test-id":"homefeed-ssr",children:(0,S.jsx)(Q.Ir,{authHomefeedComponentDidUpdate:I,feedItemProps:i&&i(p),feedKey:ed.bg,pullToRefresh:n,resource:g,serverRender:!0,trafficSource:ed.mA,visuallyCompleteProfilerOptions:j})}):(0,S.jsx)(o.az,{"data-test-id":"homefeed",children:(0,S.jsx)(Q.Ir,{authHomefeedComponentDidUpdate:I,feedItemProps:i&&i(p),feedKey:t,pullToRefresh:n,resource:g,trafficSource:ed.mA,visuallyCompleteProfilerOptions:j})})},eF=(0,eg.A)(()=>i.e("79716").then(i.bind(i,785327)),{ssr:!1},e=>785327,void 0,void 0),eO=(0,eg.A)(()=>i.e("83602").then(i.bind(i,413609)),{ssr:!1},e=>413609,void 0,void 0),eW=(0,eg.A)(()=>i.e("42948").then(i.bind(i,830255)),{ssr:!1},e=>830255,void 0,void 0),eB=(0,eg.A)(()=>i.e("78449").then(i.bind(i,153096)),{ssr:!1},e=>153096,void 0,void 0),eN=(0,eg.A)(()=>i.e("13099").then(i.bind(i,411206)),{ssr:!1},e=>411206,void 0,void 0),eV=(0,eg.A)(()=>i.e("78416").then(i.bind(i,256403)),{ssr:!1},e=>256403,void 0,void 0);class eJ extends r.PureComponent{constructor(...e){super(...e),ew(this,"state",{...(0,ea.of)(),currentTabIndex:"number"==typeof this.props.selectedTabIndex?this.props.selectedTabIndex:0,showUnlinkTokenExpiredModal:!1,showDeleteAccountSurveyModal:!1,showYipModal:!1,shouldDismissCoreActionsHeader:!1,showQRAppErrorBanner:!1}),ew(this,"renderOptInInterestPicker",()=>{let{everythingFeedExperience:e,isLimitedLogin:t}=this.props,{extraPlpImages:i,extraBlpImages:n}=this.state,r=!t&&e&&504192===e.experience_id,a=r&&e&&e.display_data&&e.display_data.full_screen_modal;return e&&r?(0,S.jsx)(c.A,{name:"SafeSuspense_HomePage_OptInInterestPicker",children:a?(0,S.jsx)(eV,{experience:e,extraImageInfo:i.length>0?i:n,viewParameter:92,viewType:1}):(0,S.jsx)(eB,{experience:e,viewParameter:92,viewType:1})}):null})}static getDerivedStateFromProps(e){let{selectedTabIndex:t,navigate:i,location:n}=e;return(0,G.A)(n.search).show_qr_app_error?(i("/",{replace:!0}),{showQRAppErrorBanner:!0}):"number"==typeof t?{currentTabIndex:t}:null}componentDidMount(){let{dispatchViewedSharedPins:e,location:t,i18n:i,showToast:n,navigate:r}=this.props,{sharedPinData:a}=this.state;(0,es.h)(!1),(0,d.A)(),a&&Object.keys(a).length>0&&e(a),t.state?.unlinkTokenInvalid&&this.setState({showUnlinkTokenExpiredModal:!0}),t.state?.isCloseAccountReasonOpen&&this.setState({showDeleteAccountSurveyModal:!0}),t.state?.showError&&n(({hideToast:e})=>(0,S.jsx)(M.A,{duration:5e3,onHide:e,text:i._('We can\u2019t find that idea! Try searching for one just like it.', ' - ', ' -- '),type:"error"})),(0,G.A)(t.search).show_yip_modal&&(r("/",{replace:!0}),this.setState({showYipModal:!0})),this.props.shouldRefreshHomefeed&&(0,$.Y9)("homefeed")}render(){let{checkExperiment:e,currentUserId:t,currentUsername:i,everythingFeedExperience:n,navigate:a,i18n:s,isAuthenticated:l,isEligibleForCoreActionsHeader:d,isPartner:h,location:_,moreIdeasStory:m,newUserWelcomeStoryExperience:f,webMobileHomeFeedTakoverExperience:x,selectedTabBoardId:b,tabBoards:g,shouldRefreshHomefeed:w}=this.props,{currentTabIndex:y,showUnlinkTokenExpiredModal:A,showDeleteAccountSurveyModal:v,showYipModal:P,shouldDismissCoreActionsHeader:j,showQRAppErrorBanner:I}=this.state,T=(0,G.A)(_.search),k=T&&T.boardId||b;if(n&&!I)switch(n.experience_id){case 40002:case 10105:return(0,S.jsx)(c.A,{name:"SafeSuspense_HomePage_Nux",children:(0,S.jsx)(B.A,{fallback:(0,S.jsx)(N.A,{accessibilityLabel:this.props.i18n._('Loading new user education', 'Loading spinner', 'Loading spinner')}),children:h?(0,S.jsx)(eW,{experience:n}):(0,S.jsx)(eO,{experience:n})})});case 500681:return(0,S.jsx)(c.A,{name:"SafeSuspense_HomePage_ContactUpdate",children:(0,S.jsx)(eF,{fallback:(0,S.jsx)(N.A,{accessibilityLabel:this.props.i18n._('Loading experience', 'loading experience spinner', 'loading experience spinner')})})})}let z=l&&e("mweb_hf_core_actions_header").anyEnabled&&d,M=()=>{this.setState({shouldDismissCoreActionsHeader:!0})};return(0,S.jsx)(K.A,{viewParameter:92,viewType:1,children:(0,S.jsx)(J.A,{view:1,viewParameter:92,children:(0,S.jsxs)(D.default,{dataLayoutShiftBoundaryId:"AuthHomePageContainer",hasFixedHeader:!0,children:[I&&(0,S.jsx)(o.az,{marginTop:4,children:(0,S.jsx)(eR,{})}),this.props.sessionSharedPinLandingInfo?.url&&this.props.sessionSharedPinLandingInfo?.inviter&&this.props.checkExperiment("ce_mweb_nux_shared_pin_banner").anyEnabled?(0,S.jsx)(ef,{inviter:this.props.sessionSharedPinLandingInfo.inviter,pinUrl:this.props.sessionSharedPinLandingInfo.url}):null,(0,S.jsx)(Z.A,{text:s._('Home', 'HomePage.HiddenAccessibilityHeader', 'Accessibility h1 at home page')}),!!g?.length&&(0,S.jsx)(L.default,{hideOnScroll:l,noPadding:!0,overrideTop:0,children:(0,S.jsx)(o.az,{paddingY:1,children:(0,S.jsx)(er,{currentTabIndex:y,tabBoards:g||[]})})}),m&&(0,S.jsx)(o.az,{marginEnd:-4,marginStart:-4,paddingY:2,children:(0,S.jsx)(eb.A,{storyId:m.id||"",children:e=>(0,S.jsx)(eA,{slotIndex:0,story:e,viewParameter:92,viewType:1},m.id)})}),0!==y&&k&&y<=(g?.length??0)&&(0,S.jsx)(eP,{boardId:k})||(0,S.jsxs)(r.Fragment,{children:[(0,S.jsx)(E,{experience:n}),(0,S.jsx)(p.Vj,{experience:n,placementId:40001}),(0,S.jsx)(p.nU,{placementId:40001}),(0,S.jsx)(p.aR,{experience:n,placementId:40001}),(0,S.jsx)(u.A,{placementId:n?.placement_id}),(0,S.jsx)(C.A,{placementId:1000544}),(0,S.jsx)(H.A,{placementId:1000558}),(0,S.jsx)(p.Je,{eligibleIds:[500726,500866,500735,500833,501182,501275,501385,501358,501908,501909,503291],experience:n,children:(0,S.jsx)(B.A,{children:(0,S.jsx)(eE,{experience:n})})}),n&&(0,S.jsx)(p.Je,{eligibleIds:[507483],experience:n,children:({dismiss:e,experience:{display_data:t}})=>{let i=!("is_blocking"in t)||t.is_blocking;return(0,S.jsx)(eS,{container:"HomePage",dismiss:e,isBlockingModal:i})}}),n&&(0,S.jsx)(p.Je,{eligibleIds:[507661],experience:n,children:({dismiss:e,experience:{display_data:t}})=>(0,S.jsx)(eI,{container:"HomePage",displayData:t,onDismiss:e})}),n&&(0,S.jsx)(p.Je,{eligibleIds:[507924],experience:n,children:({complete:e,dismiss:t})=>(0,S.jsx)(eT,{onComplete:e,onDismiss:t})}),n&&(0,S.jsx)(p.Je,{eligibleIds:[508387],experience:n,placementId:40001,children:({complete:e,dismiss:t,experience:i})=>(0,S.jsx)(ek,{complete:e,dismiss:t,experience:i})}),n&&(0,S.jsx)(p.Je,{eligibleIds:[505326],experience:n,children:({complete:e,dismiss:t})=>(0,S.jsx)(r.Suspense,{children:(0,S.jsx)(eM,{complete:e,dismiss:t})})}),n&&(0,S.jsx)(p.Je,{eligibleIds:[505801],experience:n,children:({complete:e})=>(0,S.jsx)(r.Suspense,{children:(0,S.jsx)(eC,{complete:e})})}),f?.display_data?.story&&f.display_data.showUpdatedLandingPageStory&&(0,S.jsx)(ej,{isMoreIdeasTabsVisible:!!g?.length,newUserWelcomeStoryExperience:f}),(0,S.jsxs)(o.az,{marginTop:2*(!g?.length&&!m),children:[!j&&z&&(0,S.jsx)(ey,{onDismiss:M,username:i||""}),(0,S.jsx)(eU,{webMobileHomeFeedTakoverExperience:x})]})]}),A&&(0,S.jsx)(B.A,{children:(0,S.jsx)(o.az,{"data-test-id":"unlink-expired-token",children:(0,S.jsx)(eH,{onDismiss:()=>{a("/",{replace:!0}),this.setState({showUnlinkTokenExpiredModal:!1})}})})}),v&&(0,S.jsx)(B.A,{children:(0,S.jsx)(ez,{isPartner:h,onDismiss:()=>{a("/",{replace:!0}),this.setState({showDeleteAccountSurveyModal:!1})},userId:t,username:i})}),P&&(0,S.jsx)(c.A,{name:"YearInPreviewConfirmPublishModal",children:(0,S.jsx)(eN,{onModalDismiss:()=>{this.setState({showYipModal:!1})}})}),this.renderOptInInterestPicker(),0===y&&n&&(0,S.jsx)(p.Je,{eligibleIds:[508418],experience:n,children:()=>w?(0,S.jsx)(ex,{}):(0,S.jsx)(ev,{hasTabBoards:(g?.length??0)>0})})]})})})}}let eY=[];function eG(){(0,r.useEffect)(()=>{(0,n.A)("HomePage","/app/www/pages/duplo/HomePage.tsx")},[]);let e=(0,v.A)(),t=(0,a.wA)(),i=(0,R.A)(),{showToast:o}=(0,Y.CG)(),l=(0,s.Zp)(),d=(0,s.zy)(),{checkExperiment:c}=(0,F.A)(),{shouldRefreshHomefeed:u,clearRefreshFlag:h}=(0,el.d)(),{experience:_}=(0,p.Rf)(40001),{experience:m}=(0,p.Rf)(1000115),{experience:f}=(0,p.Rf)(1000411),x=(0,a.d4)(({feeds:e})=>e.homefeed),b=(0,a.d4)(({homefeedTabUI:e})=>e.activeTabBoardId),g=(0,a.d4)(({homefeedTabUI:e})=>e.activeTabIndex),{isAuth:w,isLimitedLogin:y}=i,A=(0,a.d4)(({session:e})=>e.firstHomeFeedRequestAfterNux),P=(0,a.d4)(({session:e})=>e.sharedPinLandingInfo??null),j=i.isAuth?i.id:void 0,I=i.isAuth?i.username:void 0,T=!!i.isAuth&&i.isPartner,k=(0,q.qJ)(),z=Array.isArray(x)?x:[],E=!k&&z[0]&&"story"===z[0].type?z[0]:null,H=(0,a.d4)(({stories:e})=>E?e[E.id]:null),C=H&&H.story_type&&H.story_type.startsWith("boards_more_ideas_feed_upsell")?H:null,M=z.find(({type:e})=>"home_feed_tabs"===e)?.tabs,{data:L}=(0,W.A)(w&&c("mweb_hf_core_actions_header",{dangerouslySkipActivation:!0}).anyEnabled?{name:"UserResource",options:{user_id:i.id,field_set_key:"core_actions_header"}}:null),D=(0,q.M)();(0,U.A)(d,o,e);let O={checkExperiment:c,currentUserId:j,currentUsername:I,dispatchViewedSharedPins:e=>t({type:"SET_VIEWED_SHARED_PINS",payload:{pins:e}}),everythingFeedExperience:_,navigate:l,i18n:e,isAuthenticated:w,isEligibleForCoreActionsHeader:L?.is_eligible_for_core_actions_header,isLimitedLogin:y,isMobile:D,isPartner:T,location:d,moreIdeasStory:C,newUserWelcomeStoryExperience:f,selectedTabBoardId:b,selectedTabIndex:g,showToast:o,tabBoards:M??eY,webMobileHomeFeedTakoverExperience:m,shouldRefreshHomefeed:u,clearRefreshFlag:h,inNux:A,sessionSharedPinLandingInfo:P};return(0,S.jsx)(eJ,{...O})}},242978(e,t,i){i.d(t,{Vf:()=>o,bg:()=>r,jC:()=>s,ks:()=>l,mA:()=>a});var n=i(788332);let r="homefeed",a="feed_home",s="UserHomefeedResource",o={field_set_key:"mobile_grid_item",prepend:!1},l=(0,n.A)(o)},328673(e,t,i){i.d(t,{Y:()=>n});let n=(e,t)=>({type:"SET_ACTIVE_HOMEFEED_TAB",payload:{boardId:e,index:t}})},499053(e,t,i){i.d(t,{A:()=>n});function n(e,t){return{type:"SET_SHARED_PIN_LANDING_INFO",payload:{url:e,inviter:t}}}},987093(e,t,i){i.d(t,{AD:()=>_,X2:()=>p,e6:()=>d,sN:()=>c,x2:()=>u});var n=i(257300),r=i(974694);function a(e,t){return(0,n.A)({url:"/v3/users/{followee}/follow/",urlParams:{followee:e},method:"PUT",data:t?{invite_code:t}:{}})}function s(e){return(0,n.A)({url:"/v3/users/{followee}/follow/",urlParams:{followee:e},method:"DELETE"})}let o=(e,t,i,n)=>{let a=t().session?.userId;e((0,r.pV)(i,n)),a&&e((0,r.yX)(a,n))},l=(e,t,i,n)=>{o(e,t,i,!n)};function d(e,t=null,i,n,r){return(s,d)=>{o(s,d,e,!0),a(e,r).then(()=>{i({event_type:45,object_id_str:e,aux_data:t?{pin_id:t}:void 0,clientTrackingParams:n??void 0})}).catch(()=>{l(s,d,e,!0)})}}function c(e,t=null,i,n,r){return async(s,d)=>{o(s,d,e,!0);try{await a(e,r),i({event_type:45,object_id_str:e,aux_data:t?{pin_id:t}:void 0,clientTrackingParams:n??void 0})}catch(t){throw l(s,d,e,!0),t}}}function p(e,t=null,i,n){return(r,a)=>{o(r,a,e,!1),s(e).then(()=>{i({event_type:46,object_id_str:e,aux_data:t?{pin_id:t}:void 0,clientTrackingParams:n??void 0})}).catch(()=>{l(r,a,e,!1)})}}function u(e,t=null,i,n){return async(r,a)=>{o(r,a,e,!1);try{await s(e),i({event_type:46,object_id_str:e,aux_data:t?{pin_id:t}:void 0,clientTrackingParams:n??void 0})}catch(t){throw l(r,a,e,!1),t}}}let h=(e,t)=>({type:"USER_BULK_FOLLOW",payload:{ids:e,value:t}}),_=e=>t=>{e.length>0&&((0,n.A)({url:"/v3/users/follow/",method:"PUT",data:{followee_ids:e}}).catch(()=>t(h(e,!1))),t(h(e,!0)))}},974694(e,t,i){i.d(t,{Bt:()=>c,Fq:()=>u,LR:()=>a,Wi:()=>h,oH:()=>p,om:()=>d,pV:()=>s,yX:()=>o});var n=i(257300),r=i(805863);function a(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}let s=(e,t)=>({type:"USER_FOLLOW",payload:{id:e,value:t}}),o=(e,t)=>({type:"USER_FOLLOWING_COUNT",payload:{id:e,following:t}}),l=(e,t)=>({type:"USER_BLOCK",payload:{id:e,value:t}}),d=({id:e,orbacSubjectId:t,blockSource:i,blockContext:r,logContextEvent:a})=>async s=>{s(l(e,!0));let o=await (0,n.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"PUT",data:{orbac_subject_id:t,block_source:i,block_context:r}}).catch(()=>s(l(e,!1)));return a({event_type:54,object_id_str:e}),o},c=(e,t)=>async i=>{i(l(e,!1));let r=await (0,n.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"DELETE"}).catch(()=>i(l(e,!0)));return t({event_type:55,object_id_str:e}),r};function p(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}let u=(e,t)=>()=>(0,n.A)({url:"/v3/users/state/{state}/",urlParams:{state:e},method:"PUT",data:{value:t}}),h=(e,t,i)=>(a,s)=>{(0,n.A)({url:"/v3/users/me/",method:"POST"}).then(()=>{i({event_type:48,object_id_str:s().session.userId}),e(),(0,r.A)()},t)}},623987(e,t,i){i.d(t,{A:()=>r});var n=i(106386);function r({children:e,storyId:t}){let i=(0,n.d4)(({stories:e})=>e[t]);return i&&e(i)}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/8178-17977299d982e491.mjs.map