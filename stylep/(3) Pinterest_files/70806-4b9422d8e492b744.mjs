(self.modernJsonp=self.modernJsonp||[]).push([["70806"],{127413(e,t,n){n.d(t,{A:()=>r});var a=n(570068);let i=`pulsing {
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
}`,r={css:(0,a.m5)([i]),animation:"pulsing 2s infinite"}},119381(e,t,n){n.d(t,{A:()=>h});var a=n(61163),i=n(859471),r=n(963522),o=n(562615);let s={nw_horizontal:"inset(0 0 0 50%)",nw_vertical:"inset(50% 0 0 0)",ne_horizontal:"inset(0 50% 0 0)",ne_vertical:"inset(50% 0 0 0)",sw_horizontal:"inset(0 0 0 50%)",sw_vertical:"inset(0 0 50% 0)",se_horizontal:"inset(0 50% 0 0)",se_vertical:"inset(0 0 50% 0)"};function l({top:e,left:t,bottom:n,right:l,size:u,transition:c,opacity:p}){(0,i.useEffect)(()=>{(0,a.A)("AnchorStrokeCap","/app/packages/Cropper/AnchorStrokeCap.tsx")},[]);let d=(0,i.useMemo)(()=>{let a,i,r,o,s=(a=void 0!==e,i=void 0!==n,r=void 0!==t,o=void 0!==l,a&&r&&!i&&!o?"nw":a&&o&&!i&&!r?"ne":i&&r&&!a&&!o?"sw":i&&o&&!a&&!r?"se":"none"),u=0===e||0===n?"horizontal":0===t||0===l?"vertical":"none";return`${s}_${u}`},[e,t,n,l]),h=s[d]||"none";return(0,o.jsx)(r.az,{color:"default",dangerouslySetInlineStyle:{__style:{top:e,left:t,right:l,bottom:n,clipPath:h,transition:c,opacity:p}},"data-test-id":d,height:u,position:"absolute",rounding:"circle",width:u})}var u=n(733577);function c({anchorSize:e,corner:t,maxTouchSize:n}){(0,i.useEffect)(()=>{(0,a.A)("AnchorTouchArea","/app/packages/Cropper/AnchorTouchArea.tsx")},[]);let s=u.sU[t],l=`anchor ${t}`,c=Math.min(40,n),p=(c-e)/2,d=t.includes("n")?-p:void 0,h=t.includes("w")?-p:void 0,m=t.includes("s")?-p:void 0,y=t.includes("e")?-p:void 0;return(0,o.jsx)(r.az,{dangerouslySetInlineStyle:{__style:{top:d,left:h,bottom:m,right:y,cursor:s,pointerEvents:"auto"}},"data-test-id":`cropper-corner-${t}`,height:c,id:l,position:"absolute",width:c})}var p=n(782534);let d=({x:e,y:t,size:n})=>`linear-gradient(black, black) ${e}px ${t}px / ${n}px ${n}px no-repeat`;function h({anchorSelection:e,h:t,handleCount:n,size:s,transition:u,visibility:h,w:m,x:y,y:f}){(0,i.useEffect)(()=>{(0,a.A)("CropperAnchors","/app/packages/Cropper/CropperAnchors.tsx")},[]);let x=2===n,b=x?.75:1,g=s/2,_=6-!x-3+(0,p.A)({w:m,h:t,minSize:3,maxSize:0}),v=m+2*g-2*_,w=t+2*g-2*_,M=Math.max(16-(20-s),10),A=s-2,S=A-2,k=(Math.min(v,w)-8)/2,z="ne"===e?1:b,$=d({x:v-A,y:0,size:A}),j="nw"===e?1:b,C=d({x:0,y:0,size:A}),R="sw"===e?1:b,I=d({x:0,y:w-A,size:A}),E="se"===e?1:b,W=d({x:v-A,y:w-A,size:A});return(0,o.jsxs)(r.az,{dangerouslySetInlineStyle:{__style:{top:f-g+_,left:y-g+_,pointerEvents:"none",visibility:h,transition:u}},height:w,position:"absolute",width:v,children:[(0,o.jsx)(r.az,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:"4px solid white",borderRadius:`${M}px`,mask:$,pointerEvents:"none",transition:u,opacity:z}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,o.jsx)(l,{opacity:z,right:0,size:4,top:S,transition:u}),(0,o.jsx)(l,{opacity:z,right:S,size:4,top:0,transition:u}),(0,o.jsx)(c,{anchorSize:s,corner:"ne",maxTouchSize:k}),(0,o.jsx)(r.az,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:"4px solid white",borderRadius:`${M}px`,mask:I,pointerEvents:"none",transition:u,opacity:R}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,o.jsx)(l,{bottom:0,left:S,opacity:R,size:4,transition:u}),(0,o.jsx)(l,{bottom:S,left:0,opacity:R,size:4,transition:u}),(0,o.jsx)(c,{anchorSize:s,corner:"sw",maxTouchSize:k}),!x&&(0,o.jsxs)(i.Fragment,{children:[(0,o.jsx)(r.az,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:"4px solid white",borderRadius:`${M}px`,mask:C,pointerEvents:"none",transition:u,opacity:j}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,o.jsx)(l,{left:0,opacity:j,size:4,top:S,transition:u}),(0,o.jsx)(l,{left:S,opacity:j,size:4,top:0,transition:u}),(0,o.jsx)(c,{anchorSize:s,corner:"nw",maxTouchSize:k}),(0,o.jsx)(r.az,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:"4px solid white",borderRadius:`${M}px`,mask:W,pointerEvents:"none",transition:u,opacity:E}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,o.jsx)(l,{bottom:0,opacity:E,right:S,size:4,transition:u}),(0,o.jsx)(l,{bottom:S,opacity:E,right:0,size:4,transition:u}),(0,o.jsx)(c,{anchorSize:s,corner:"se",maxTouchSize:k})]})]})}},245369(e,t,n){n.d(t,{A:()=>w});var a=n(61163),i=n(859471),r=n(963522),o=n(743372),s=n(733577),l=n(119381),u=n(526131),c=n(470451),p=n(789106),d=n(782534),h=n(33658),m=n(156128),y=n(538329);let f="ArrowDown",x="ArrowLeft",b="ArrowRight",g="ArrowUp";var _=n(931509),v=n(562615);function w({children:e,cropArea:{x:t,y:n,w:w,h:M},cropSource:A,handleCount:S=2,hoveredCutoutIndex:k,imageContainerX:z,imageContainerY:$,imageSize:{width:j=1,height:C=1},objectDetection:R,onChange:I,pinId:E,setHoveredCutoutIndex:W,setSelectedCutoutIndex:O,viewParameter:T,viewType:F}){(0,i.useEffect)(()=>{(0,a.A)("CropperV2","/app/packages/Cropper/CropperV2.tsx")},[]);let P=(0,o.A)(),L=(0,y.A)(),B=(0,i.useRef)(null),D=(0,i.useRef)(null),U=(0,i.useMemo)(()=>({x:0,y:0,w:j,h:C}),[C,j]),V=(0,i.useMemo)(()=>(0,c.A)({cropArea:{x:t,y:n,w:w,h:M},imageSize:{width:j,height:C}}),[M,w,t,n,C,j]),[N,G]=(0,i.useState)(()=>(0,h.Ay)({x:t,y:n,w:w,h:M},U)?U:V),H=(0,i.useMemo)(()=>(0,h.Ay)(N,U),[N,U]),[J,q]=(0,i.useState)("none"),[K,X]=(0,i.useState)("none"),[Y,Z]=(0,i.useState)(!1),[Q,ee]=(0,i.useState)(!1),[et,en]=(0,i.useState)(!1),[ea,ei]=(0,i.useState)(0),[er,eo]=(0,i.useState)(0),[es,el]=(0,i.useState)(!1),eu=(0,i.useRef)(null),{x:ec,y:ep,w:ed,h:eh}=N,em=(0,i.useMemo)(()=>(0,d.A)({w:ed,h:eh,minSize:14,maxSize:20}),[eh,ed]),ey=j-16,ef=C-16,ex="number"==typeof k,eb=Q||es?"none":"0.3s cubic-bezier(0.42, 0, 0.58, 1.2)",eg=(0,u.A)({cropperSelection:J,anchorSelection:K,hasMouseMoved:Q}),e_=function({cropperSelection:e,cropSource:t,hasClickedOnObject:n,isTargetOnObject:a}){return("none"===e||a)&&(9===t||n)?.2:0}({cropperSelection:J,isTargetOnObject:Y,cropSource:A,hasClickedOnObject:et}),ev=e=>{e.preventDefault();let{clientX:t,clientY:n,target:a}=e,i=t-z,r=n-$;ee(!1),en(!1),ei(i),eo(r);let{id:o}=a,[s,l="none"]=o.split(" "),u="anchor"==`${s}`,c=o===m.z,p=o===_.J4;u?(q("anchor"),X(l)):(!(ec<i&&i<ec+ed&&ep<r&&r<ep+eh)||H?q("background"):q("cropbox"),Z(c||p))},ew=e=>{if("none"===J)return;let{clientX:t,clientY:n}=e,a=t-z,i=n-$;if(!(2>Math.abs(a-ea)&&2>Math.abs(i-er)&&!Q&&["cropbox","background"].includes(J)))switch(ee(!0),Z(!1),W?.(null),O?.(-1),J){case"anchor":{let e=["nw","sw"].includes(K),t=["nw","ne"].includes(K),n=Math.max(Math.min(a,ey),16),r=Math.max(Math.min(i,ef),16);G({x:e?Math.min(n,ec+ed-20):ec,y:t?Math.min(r,ep+eh-20):ep,w:e?Math.max(ec+ed-n,20):Math.max(n-ec,20),h:t?Math.max(ep+eh-r,20):Math.max(r-ep,20)});break}case"cropbox":{let e=Math.max(Math.min(ec+(a-ea),j-ed-16),16),t=Math.max(Math.min(ep+(i-er),C-eh-16),16);ei(a),eo(i),G({x:e,y:t,w:ed,h:eh});break}case"background":{let e=Math.max(Math.min(a,j),0),t=Math.max(Math.min(i,C),0),n=e-ea,r=t-er;G({x:Math.min(ea,e),y:Math.min(er,t),w:Math.abs(n),h:Math.abs(r)})}}},eM=()=>{if(q("none"),X("none"),Z(!1),ee(!1),"none"===J)return;if(Y&&("cutouts"===R&&ex||"dots"===R))return void en(!0);let e=(e,t)=>{I({cropArea:e,cropSource:t}),G(e)};if(Q){let t=Math.max(Math.min(ec,j-20-16),16),n=Math.max(Math.min(ep,C-20-16),16),a=eh<20?20:n+eh>C-16?C-n-16:eh,i=ed<20?20:t+ed>j-16?j-t-16:ed;e({x:t,y:n,w:i,h:a},6),"cropbox"===J?P({event_type:7603,view_type:F,view_parameter:T,...E&&{object_id_str:E}}):"anchor"===J?P({event_type:7604,view_type:F,view_parameter:T,...E&&{object_id_str:E}}):"background"===J&&P({event_type:16584,view_type:F,view_parameter:T,...E&&{object_id_str:E}})}else H||"background"===J?(e((0,p.A)({mouseX:ea,mouseY:er,cropSize:120,minBound:16,imageWidth:j,imageHeight:C}),6),P({event_type:16585,view_type:F,view_parameter:T,...E&&{object_id_str:E}})):"cropbox"===J&&(e(U,5),P({event_type:16586,view_type:F,view_parameter:T,...E&&{object_id_str:E}}))};return(0,i.useEffect)(()=>{et&&G(V)},[V,et]),(0,i.useEffect)(()=>()=>{null!==eu.current&&(clearTimeout(eu.current),eu.current=null)},[]),(0,i.useEffect)(()=>{let e=B.current;return e?.addEventListener("mousedown",ev),window.addEventListener("mousemove",ew),window.addEventListener("mouseup",eM),()=>{e?.removeEventListener("mousedown",ev),window.removeEventListener("mousemove",ew),window.removeEventListener("mouseup",eM)}}),(0,v.jsxs)(r.az,{ref:B,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:eg}},"data-test-id":"visual-search-cropper",left:!0,position:"absolute",right:!0,top:!0,children:[(0,v.jsx)(r.az,{dangerouslySetInlineStyle:{__style:{border:"0px solid rgba(255, 255, 255, 0.20)",borderRadius:`${10-em}px`,boxShadow:"0 0 0 99999px rgba(0, 0, 0, 0.35)",left:ec,top:ep,transition:eb,backgroundColor:`rgba(0, 0, 0, ${e_})`}},height:eh,position:"absolute",width:ed}),(0,v.jsx)(r.az,{bottom:!0,id:s.zu,left:!0,position:"absolute",right:!0,top:!0}),(0,v.jsx)(r.az,{ref:D,"aria-describedby":"cropper-keyboard-instructions","aria-label":L._('Crop selection', 'visualSearch.cropper.ariaLabel', 'Accessibility label for the crop selection area'),dangerouslySetInlineStyle:{__style:{visibility:H?"hidden":"visible",left:ec,top:ep,pointerEvents:"none"}},"data-test-id":"cropper-section",height:eh,id:s._c,onBlur:()=>el(!1),onKeyDown:e=>{if(H)return;let t=j-ed-16,n=C-eh-16,a=ec,i=ep,r=ed,o=eh;if(e.shiftKey)switch(e.key){case g:(o=Math.min(ef-(i=Math.max(16,ep-8)),eh+(ep-i)+8))<20&&(o=20,i=ep+eh-20);break;case f:i=Math.max(16,Math.min(ef-(o=Math.max(20,eh-16)),ep+8));break;case b:(r=Math.min(ey-(a=Math.max(16,ec-8)),ed+(ec-a)+8))<20&&(r=20,a=ey-20);break;case x:a=Math.max(16,Math.min(ey-(r=Math.max(20,ed-16)),ec+8));break;default:return}else switch(e.key){case x:a=Math.max(16,ec-8);break;case b:a=Math.min(t,ec+8);break;case g:i=Math.max(16,ep-8);break;case f:i=Math.min(n,ep+8);break;default:return}e.preventDefault(),el(!0);let s={x:a,y:i,w:r,h:o};G(s),null!==eu.current&&clearTimeout(eu.current),eu.current=setTimeout(()=>{eu.current=null,el(!1),I({cropArea:s,cropSource:6})},500)},position:"absolute",tabIndex:H?void 0:0,width:ed}),(0,v.jsx)(r.az,{as:"p",display:"none",id:"cropper-keyboard-instructions",children:L._('Use arrow keys to move the selection. Hold Shift and use arrow keys to resize: Up and Right grow the selection, Down and Left shrink it.', 'visualSearch.cropper.keyboardInstructions', 'Instructions for screen readers on how to use keyboard to move and resize the crop selection')}),e,(0,v.jsx)(l.A,{anchorSelection:K,h:eh,handleCount:S,size:20-em,transition:eb,visibility:H||"background"===J&&Q?"hidden":"visible",w:ed,x:ec,y:ep})]})}},526131(e,t,n){n.d(t,{A:()=>a});function a({cropperSelection:e,anchorSelection:t,hasMouseMoved:n}){if("background"===e&&n)return"crosshair";if("cropbox"===e&&n)return"move";if("anchor"===e){if("nw"===t||"se"===t)return"nwse-resize";else if("ne"===t||"sw"===t)return"nesw-resize"}return"auto"}},470451(e,t,n){function a({cropArea:e,imageSize:t}){let{x:n,y:a,w:i,h:r}=e,{height:o,width:s}=t;if(!o||!s)return e;let l=n,u=a,c=i,p=r;return l<16&&(l=16,c-=16-n),l+c>s-16&&(c-=l+c-s+16),u<16&&(u=16,p-=16-a),u+p>o-16&&(p-=u+p-o+16),{x:l,y:u,w:c,h:p}}n.d(t,{A:()=>a}),n(733577)},789106(e,t,n){n.d(t,{A:()=>i});let a=({coordinate:e,cropSize:t,maxBound:n,minBound:a})=>e<=a?a:n<=e+t?n-t:e;function i({cropSize:e,imageHeight:t,imageWidth:n,minBound:i,mouseX:r,mouseY:o}){let s=r-e/2,l=o-e/2,u=n-i,c=t-i;return{x:a({coordinate:s,minBound:i,maxBound:u,cropSize:e}),y:a({coordinate:l,minBound:i,maxBound:c,cropSize:e}),w:e,h:e}}},782534(e,t,n){function a({w:e,h:t,minSize:n,maxSize:a}){let i=Math.min(e,t);return i<=20?a-n:i<32?(a-n)/12*(32-i):0}n.d(t,{A:()=>a}),n(733577)},156128(e,t,n){n.d(t,{A:()=>p,z:()=>l});var a=n(61163),i=n(859471),r=n(963522),o=n(538329),s=n(562615);let l="flashlight-dot-style",u=16,c=32,p=({icon:e,onClick:t,onMouseDown:n,onMouseEnter:p,onMouseLeave:d,onMouseUp:h,selected:m,style:y,text:f,x,y:b,zIndex:g,backdropDiameter:_=c,dotDiameter:v=u,containerRef:w})=>{(0,i.useEffect)(()=>{(0,a.A)("Dot","/app/packages/Flashlight/Dot.tsx")},[]);let[M,A]=(0,i.useState)(!1),S=(0,o.A)(),k=M?_+4:_;return(0,s.jsx)(r.az,{ref:w,dangerouslySetInlineStyle:{__style:{top:b-k/2,left:x-k/2,outline:"none"}},position:"absolute",zIndex:new r.rk(g||0),children:(0,s.jsx)(r.Rp,{accessibilityLabel:S._('Search this item', 'flashlight.dot.a11ylabel', 'accessibility label for flashlight dot'),dataTestId:"flashlight-dot",onMouseDown:n,onMouseEnter:({event:e})=>{A(!0),p?.({event:e})},onMouseLeave:({event:e})=>{A(!1),d?.({event:e})},onMouseUp:h,onTap:t,tabIndex:0,children:(0,s.jsxs)(r.az,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{boxShadow:m?"0 0 0 3px #e60023":"none",borderRadius:v,top:(k-v)/2,left:(k-v)/2,...y}},"data-test-id":l,display:"flex",height:v,id:l,justifyContent:"center",padding:0,position:"absolute",width:v,children:[!!f&&(0,s.jsx)(r.KJ,{align:"center",color:"default",inline:!0,size:"100",weight:"bold",children:f}),e&&(0,s.jsx)(r.In,{accessibilityLabel:S._('Tag anchor', 'accessibility label for an anchor for an object in a pin', 'accessibility label for an anchor for an object in a pin'),color:"error",icon:e,inline:!0,size:v/2})]})})})}},210909(e,t,n){n.r(t),n.d(t,{default:()=>j});var a=n(61163),i=n(859471),r=n(963522),o=n(182267),s=n(586733),l=n(489630);function u(e,t,n){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:a+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let c={},p=e=>{let t=e.__id||e.id;return"string"==typeof t&&t||null};class d{constructor(){u(this,"idMap",new Map),u(this,"objMap",new WeakMap)}get(e){let t=p(e);return this.objMap.get(e)??(t?this.idMap.get(t):void 0)}has(e){let t=p(e);return this.objMap.has(e)??(!!t&&this.idMap.has(t))}set(e,t){let n=p(e);n&&this.idMap.set(n,t),this.objMap.set(e,t)}reset(){this.idMap=new Map,this.objMap=new WeakMap}}var h=n(909179);function m(e,t){return"number"==typeof e?e:"lg1"===t?e[t]??e.lg??1:e[t]??1}var y=n(411805),f=n(11978),x=n(127413),b=n(131094),g=n(562615);let{css:_,animation:v}=x.A,w={backgroundColor:"var(--sema-color-background-secondary)",animation:v,borderRadius:"var(--sema-rounding-400)"};function M({data:e}){(0,i.useEffect)(()=>{(0,a.A)("SkeletonPin","/app/common/react/components/SkeletonLoadingStates/SkeletonPin.tsx")},[]);let{height:t}=e;return(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)(b.A,{unsafeCSS:_}),(0,g.jsx)(r.az,{dangerouslySetInlineStyle:{__style:w},"data-test-id":"skeleton-pin",children:(0,g.jsx)(r.az,{height:t})})]})}var A=n(601185),S=n(844255),k=n(971289),z=n(81920),$=n(912849);function j(e){(0,i.useEffect)(()=>{(0,a.A)("Masonry","/app/packages/gestaltExtensions/Masonry/Masonry.tsx")},[]);let{align:t,cacheKey:n,id:u,isFetching:p,isGridCentered:x=!0,items:_,layout:v,loadItems:w,masonryRef:j,optOutFluidGridExperiment:C=!1,renderItem:R,scrollContainerRef:I,virtualize:E=!0,getColumnSpanConfig:W,_getResponsiveModuleConfigForSecondItem:O,isLoadingStateEnabled:T,initialLoadingStatePinCount:F,isLoadingAccessibilityLabel:P,isLoadedAccessibilityLabel:L}=e,B=(0,k.Ay)(),{isAuthenticated:D,isRTL:U,userAgent:V,stage:N}=(0,S._8)(),{browserName:G,platform:H}=V,{logContextEvent:J}=(0,s.o)(),q=(0,A.A)(),K="desktop"===B,X=(0,$.AJ)(),Y=((0,i.useRef)(_.map(()=>({fetchTimestamp:Date.now(),measureTimestamp:Date.now(),hasRendered:!1,pageCount:0}))),K&&!C),{experimentalColumnWidth:Z,experimentalGutter:Q}=(0,y.A)(Y),ee=e.serverRender??!!K,et="flexible"===v||"uniformRowFlexible"===v||"desktop"!==B||Y,en=(et&&v?.startsWith("uniformRow")?"uniformRowFlexible":void 0)??(ee?"serverRenderedFlexible":"flexible"),ea=e.columnWidth??Z??236;et&&(ea=Math.floor(ea));let ei=e.gutterWidth??Q??(K?16:1),er=e.minCols??2,eo=((0,i.useRef)(0),ea+ei),es=function(e){let t;if(null==e)return;let n=((t=c[e])&&t.screenWidth===window.innerWidth||(c[e]={screenWidth:window.innerWidth}),c[e]);return n.measurementCache||(n.measurementCache=new d),n.measurementCache}(n),el=(0,i.useCallback)(()=>I?.current||window,[I]),eu=(0,i.useRef)(!0),{anyEnabled:ec}=q.checkExperiment("visual_search_stl_eligibility_check_migration_gss_css",{dangerouslySkipActivation:!0}),{group:ep}=q.checkExperiment("web_nav_sidebar",{dangerouslySkipActivation:!0}),ed=ep.startsWith("enabled_autoclose_reduce_debounce")?Number(ep.split("enabled_autoclose_reduce_debounce_")[1]):void 0,eh=x&&eu.current?"centered":"",{className:em,styles:ey}=function(e){let t=`m_${(0,h.A)(e).sort().reduce((t,n)=>{let a=e[n];return null==a||"object"==typeof a||"function"==typeof a?t:"boolean"==typeof a?t+(a?"t":"f"):t+a},"").replace(/\:/g,"\\:")}`,{flexible:n,gutterWidth:a,isRTL:i,itemWidth:r,maxColumns:o,minColumns:s,items:l,getColumnSpanConfig:u,_getResponsiveModuleConfigForSecondItem:c}=e,p=u?l.map((e,t)=>({index:t,columnSpanConfig:u(e)??1})).filter(e=>1!==e.columnSpanConfig):[],d=r+a,y=Array.from({length:o+1-s},(e,t)=>t+s).map(e=>{let h,y,f=e===s?0:e*d,x=e===o?null:(e+1)*d-.01;u&&c&&l.length>1&&(h=u(l[0]),y=c(l[1]));let{styles:b,numberOfVisibleItems:g}=p.reduce((i,o)=>{let{columnSpanConfig:s}=o,u=Math.min(function({columnCount:e,columnSpanConfig:t,firstItemColumnSpanConfig:n,isFlexibleWidthItem:a,secondItemResponsiveModuleConfig:i}){let r=e<=2?"sm":e<=4?"md":e<=6?"lg1":e<=8?"lg":"xl",o=m(t,r);if(a){let t=m(n,r);o="number"==typeof i?i:i?Math.max(i.min,Math.min(i.max,e-t)):1}return o}({columnCount:e,columnSpanConfig:s,isFlexibleWidthItem:!!y&&o===l[1],firstItemColumnSpanConfig:h??1,secondItemResponsiveModuleConfig:y??1}),e),c=null!=o.index&&i.numberOfVisibleItems>=u+o.index,p=n?100/e*u:r*u+a*(u-1),{numberOfVisibleItems:d}=i;return c?d-=u-1:o.index<d&&(d+=1),{styles:i.styles.concat(function({className:e,index:t,columnSpanConfig:n,visible:a,width:i,flexible:r}){let o="number"==typeof n?n:btoa(JSON.stringify(n));return r?`
      .${e} .static[data-column-span="${o}"]:nth-child(${t+1}) {
        visibility: ${a?"visible":"hidden"} !important;
        position: ${a?"inherit":"absolute"} !important;
        width: ${i}% !important;
      }`:`
      .${e} .static[data-column-span="${o}"]:nth-child(${t+1}) {
        visibility: ${a?"visible":"hidden"} !important;
        position: ${a?"inherit":"absolute"} !important;
        width: ${i}px !important;
      }`}({className:t,index:o.index,columnSpanConfig:s,visible:c,width:p,flexible:n})),numberOfVisibleItems:d}},{styles:"",numberOfVisibleItems:e}),_=n?`
      .${t} .static {
        box-sizing: border-box;
        width: calc(100% / ${e}) !important;
      }
    `:`
      .${t} {
        max-width: ${e*d}px;
      }

      .${t} .static {
        width: ${r}px !important;
      }
    `;return{minWidth:f,maxWidth:x,styles:`
      .${t} .static:nth-child(-n+${g}) {
        position: static !important;
        visibility: visible !important;
        float: ${i?"right":"left"};
        display: block;
      }

      .${t} .static {
        padding: 0 ${a/2}px;
      }

      ${_}

      ${b}
    `}}),f=y.map(({minWidth:e,maxWidth:t,styles:n})=>`
    @container (min-width: ${e}px) ${t?`and (max-width: ${t}px)`:""} {
      ${n}
    }
  `),x=y.map(({minWidth:e,maxWidth:t,styles:n})=>`
    @media (min-width: ${e}px) ${t?`and (max-width: ${t}px)`:""} {
      ${n}
    }
  `),b=`
    ${f.join("")}
    @supports not (container-type: inline-size) {
      ${x.join("")}
    }
  `;return{className:t,styles:`
    .masonryContainer:has(.${t}) {
      container-type: inline-size;
    }

    .masonryContainer > .centered {
      margin-left: auto;
      margin-right: auto;
    }

    .${t} .static {
      position: absolute !important;
      visibility: hidden !important;
    }

    ${b}
  `}}({gutterWidth:ei,flexible:et,items:_,isRTL:U,itemWidth:ea,maxColumns:e.maxColumns??Math.max(_.length,16),minColumns:er,getColumnSpanConfig:W,_getResponsiveModuleConfigForSecondItem:O}),ef=`${eh} ${em}`.trim(),{anyEnabled:ex,expName:eb,group:eg,isMeasureAllEnabled:e_}=(0,f.A)(),ev=((0,i.useRef)(void 0),(0,i.useRef)(_.length)),ew=(0,i.useRef)(0),eM=(0,i.useRef)(null);(0,i.useEffect)(()=>{ev.current=_.length,ew.current+=1},[_]),(0,i.useEffect)(()=>{eu.current&&(eu.current=!1)},[]),(0,i.useEffect)(()=>()=>{},[]);let eA=(0,i.useCallback)(e=>{let t=e.reduce((e,t)=>e+t),n=t/e.length,a={experimentalMasonryGroup:eg||"unknown",handlerId:X,isAuthenticated:D,multiColumnItemSpan:e.length,browserName:G,platform:H,stage:N||"unknown"};(0,z.GV)("webapp.masonry.multiColumnWhitespace.count",{sampleRate:1,tags:a}),(0,z.uI)("webapp.masonry.multiColumnWhitespace.average",n,{sampleRate:1,tags:{...a,minCols:er}}),J({event_type:15878,component:14468,aux_data:{total_whitespace_px:t}}),J({event_type:16062,component:14468,aux_data:{average_whitespace_px:n}}),J({event_type:16063,component:14468,aux_data:{max_whitespace_px:Math.max(...e)}}),e.forEach(e=>{e>=50&&((0,z.GV)("webapp.masonry.multiColumnWhitespace.over50",{sampleRate:1,tags:a}),J({event_type:16261,component:14468})),e>=100&&((0,z.GV)("webapp.masonry.multiColumnWhitespace.over100",{sampleRate:1,tags:a}),J({event_type:16262,component:14468}))})},[G,eg,X,D,J,er,H,N]),{_items:eS,_renderItem:ek}=function({initialLoadingStatePinCount:e=50,infiniteScrollPinCount:t=10,isFetching:n,items:a=[],renderItem:r,isLoadingStateEnabled:o}){let s=+(a.filter(e=>"object"==typeof e&&null!==e&&"type"in e&&"closeup_module"===e.type).length>0),l=o&&n,u=(0,i.useMemo)(()=>Array.from({length:a.length>s?t:e}).reduce((e,t,n)=>[...e,{height:n%2==0?356:236,key:`skeleton-pin-${n}`,isSkeleton:!0}],[]),[a.length,s,t,e]);return{_items:(0,i.useMemo)(()=>l?[...a,...u]:a,[l,a,u]),_renderItem:(0,i.useMemo)(()=>o?e=>{let{itemIdx:t,data:n}=e;return t>=a.length&&n&&"object"==typeof n&&"key"in n&&"height"in n?(0,g.jsx)(M,{data:n},n.key):r(e)}:r,[o,r,a.length])}}({isLoadingStateEnabled:T,items:_,renderItem:(0,i.useCallback)(e=>(0,g.jsx)(l.A,{name:"MasonryItem",children:R(e)}),[R]),isFetching:p,initialLoadingStatePinCount:F}),ez=T&&p,e$=(0,i.useRef)(new Set);(0,i.useEffect)(()=>{let e={isAuthenticated:D,isDesktop:"desktop"===B,handlerId:X,experimentalMasonryGroup:eg||"unknown",visualSearchSTLexperiment:ec?"true":"false",browserName:G,platform:H,stage:N||"unknown"},t=setTimeout(()=>{requestAnimationFrame(()=>{let t=Array.from(eM.current?.querySelectorAll("[data-grid-item-idx]")??[]);if(0===t.length)return;let n=t.map(e=>{let t=e.getAttribute("data-grid-item-idx");return{rect:e.getBoundingClientRect(),itemIdx:t}}),a=0,i=0,r=0,o=0,s=0,l=0;for(let e=0;e<n.length;e+=1){let t=n[e]?.rect,u=n[e]?.itemIdx;for(let c=e+1;c<n.length;c+=1){let e=n[c]?.rect,p=n[c]?.itemIdx;if(t&&e&&u&&p){let n=[u,p].sort().join("|");if(!e$.current.has(n)&&t.right>=e.left&&t.left<=e.right&&t.bottom>=e.top&&t.top<=e.bottom&&t.height>0&&e.height>0){e$.current.add(n),a+=1;let u=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));u>8e4?l+=1:u>4e4?s+=1:u>1e4?o+=1:u>5e3?r+=1:u>2500&&(i+=1)}}}}a>0&&(0,z.U9)("webapp.masonry.pinOverlapHits",a,{tags:e,sampleRate:.02}),i>0&&(0,z.U9)("webapp.masonry.pinOverlap.AreaPx.over2500",i,{tags:e,sampleRate:.02}),r>0&&(0,z.U9)("webapp.masonry.pinOverlap.AreaPx.over5000",r,{tags:e,sampleRate:.02}),o>0&&(0,z.U9)("webapp.masonry.pinOverlap.AreaPx.over10000",o,{tags:e,sampleRate:.02}),s>0&&(0,z.U9)("webapp.masonry.pinOverlap.AreaPx.over40000",s,{tags:e,sampleRate:.02}),l>0&&(0,z.U9)("webapp.masonry.pinOverlap.AreaPx.over80000",l,{tags:e,sampleRate:.02});let u="none";u=n.length<=10?"0-10":n.length<=20?"11-20":">20";let c="none";c=a>0&&a<=5?"1-5":a>5&&a<=20?"6-20":a>20&&a<=100?"21-100":">100",(0,z.GV)("webapp.masonry.pinOverlap.onOverlapCalculation",{tags:{...e,hasAnyOverlap:a>0?"true":"false",hasOverlapAreaOver2500:i>0?"true":"false",hasOverlapAreaOver5000:r>0?"true":"false",hasOverlapAreaOver10000:o>0?"true":"false",hasOverlapAreaOver40000:s>0?"true":"false",hasOverlapAreaOver80000:l>0?"true":"false",itemsMeasured:u,overlapPairs:c},sampleRate:.02})})},1e3);return()=>{clearTimeout(t)}},[G,B,eg,D,X,H,N,ec]);let ej=(0,o.A)(),eC=(0,i.useCallback)(e=>{j&&(j.current=e)},[j]);return(0,g.jsxs)(i.Fragment,{children:[T&&!eu.current&&(0,g.jsx)(r.az,{"aria-live":"polite",display:"visuallyHidden",children:ez?P:L}),(0,g.jsx)("div",{ref:eM,"aria-busy":T?!!ez:void 0,className:"masonryContainer","data-test-id":"masonry-container",id:u,style:Y?{padding:`0 ${ei/2}px`}:void 0,children:(0,g.jsxs)("div",{className:ef,children:[ee&&eu.current?(0,g.jsx)(b.A,{"data-test-id":"masonry-ssr-styles",unsafeCSS:ey}):null,(0,g.jsx)(r.az,{"data-test-id":"max-width-container",marginBottom:0,marginEnd:"auto",marginStart:"auto",marginTop:0,maxWidth:e.maxColumns?eo*e.maxColumns:void 0,children:ex?(0,g.jsx)(r._6,{ref:ej?eC:e=>{j&&(j.current=e)},_dynamicHeights:!0,_getResponsiveModuleConfigForSecondItem:O,_logTwoColWhitespace:eA,_measureAll:e_,align:t,columnWidth:ea,getColumnSpanConfig:W,gutterWidth:ei,items:eS,layout:et?en:v??"basic",loadItems:w,measurementStore:es,minCols:er,renderItem:ek,scrollContainer:el,virtualBufferFactor:.3,virtualize:E}):(0,g.jsx)(r.a,{ref:ej?eC:e=>{j&&(j.current=e)},_dynamicHeights:!0,_experimentalFluidResizeDebounce:void 0!==ed&&ed>=0?ed:void 0,_fluidResize:!0,_getResponsiveModuleConfigForSecondItem:O,_logTwoColWhitespace:eA,align:t,columnWidth:ea,getColumnSpanConfig:W,gutterWidth:ei,items:eS,layout:et?en:v??"basic",loadItems:w,measurementStore:es,minCols:er,renderItem:ek,scrollContainer:el,virtualBufferFactor:.3,virtualize:E})})]})})]})}},937092(e,t,n){n.d(t,{A:()=>a});function a(e,t){let n=0,a=!1,i=-1;return e.forEach((e,r)=>{let{x:o=0,y:s=0,h:l=0,w:u=0}=e,c=function(e,t){let{x:n,y:a,w:i,h:r}=e,{x:o,y:s,w:l,h:u}=t,c=Math.max(n,o),p=Math.min(n+i,o+l),d=Math.max(a,s),h=Math.min(a+r,s+u),m=c<p&&d<h?(p-c)*(h-d):0;return m/(i*r+l*u-m)}(t,{x:o,y:s,h:l,w:u});c>=.9&&c>n&&(n=c,a=!0,i=r)}),{isCropAreaOnDotArea:a,indexToHide:i}}},476410(e,t,n){n.d(t,{A:()=>a});function a({cropArea:{x:e,y:t,w:n,h:a},scaledWidth:i,scaledHeight:r}){return{x:e/i,y:t/r,w:n/i,h:a/r}}},931509(e,t,n){n.d(t,{CI:()=>i,J4:()=>a,PI:()=>r});let a="stela-cutout",i="cutout-fade",r=`
  .${i}-appear {
    opacity: 0;
  }
  .${i}-appear-active {
    opacity: 1;
    transition: opacity 2000ms;
  }
  .${i}-appear-done {
    opacity: 1;
  }

  .${i}-enter {
    opacity: 0;
  }
  .${i}-enter-active {
    opacity: 1;
    transition: opacity 300ms;
  }
  .${i}-enter-done {
    opacity: 1;
  }

  .${i}-exit {
    opacity: 1;
  }
  .${i}-exit-active {
    opacity: 0;
    transition: opacity 300ms;
  }
  .${i}-exit-done {
    opacity: 0;
  }
`},627012(e,t,n){n.d(t,{A:()=>r});var a=n(859471),i=n(601185);function r(){let{checkExperiment:e}=(0,i.A)(),{group:t}=e("dtn_exp6_uve4a");return(0,a.useMemo)(()=>{let e={client:"visual_cutout",cleanup_masks:!0};return"enabled"===t?{...e,detection_model:"dtn_exp6_yolov8"}:"enabled_dtn_exp5_skip_gss"===t?{...e,use_gss:!1,write_to_galaxy:!1}:e},[t])}},676791(e,t,n){n.d(t,{B1:()=>r,LG:()=>a,gy:()=>o,wq:()=>i});let a=(e,t,n)=>{let{maskX:a,maskY:i,maskWidth:r,maskHeight:o}=n;return e>=a&&e<=a+r&&t>=i&&t<=i+o},i=(e,t,n)=>{if(t<0||n<0||t>=e.canvas.width||n>=e.canvas.height)return!1;try{let a=e.getImageData(t,n,1,1).data[0];return void 0!==a&&a>0}catch{return!1}},r=e=>{let{id:t,mask_image:n,mask_bounds:a}=e;if(!t||!n||!a||2!==a.length)return!1;let[i,r]=a;if(!i||!r||2!==i.length||2!==r.length)return!1;let[o,s]=i,[l,u]=r;return[o,s,l,u].every(e=>"number"==typeof e&&!Number.isNaN(e))},o=(e,t,n)=>{if(!r(e))return null;let{id:a,mask_image:i,mask_bounds:o,is_hidden:s}=e,[l,u]=o[0],[c,p]=o[1],d=(e=>{try{let t=atob(e),n=Uint8Array.from(t,e=>e.charCodeAt(0)),a=new Blob([n],{type:"image/png"});return URL.createObjectURL(a)}catch{return null}})(i);return d?{maskData:{id:a,isHidden:!!s,maskHeight:p*n,maskHeightRatio:p,maskUrl:d,maskWidth:c*t,maskWidthRatio:c,maskX:l*t,maskXRatio:l,maskY:u*n,maskYRatio:u},maskUrl:d}:null}},860176(e,t,n){n.d(t,{A:()=>r});var a=n(859471),i=n(431802);function r(e){return(0,a.useMemo)(()=>{let[t,n]=(0,i.Rv)({hexColor:e||"#FFFFFF",saturationMultiplier:3,brightnessMultiplier:1.6,minSaturationClamp:.15,mixVal:.3,minBrightnessClamp:0}),a=`rgba(${n[0]}, ${n[1]}, ${n[2]}, 0.8)`,r=`rgba(${t[0]}, ${t[1]}, ${t[2]}, 0.8)`,o=(0,i.hh)((0,i.I0)((0,i.t8)("rgba(117, 117, 112, 0.2)"),(0,i.t8)(a))),s=(0,i.hh)((0,i.I0)((0,i.t8)("rgba(117, 117, 112, 0.4)"),(0,i.t8)(a)));return{defaultColor:a,selectedColor:r,hoveredColor:o,pressedColor:s}},[e])}},307273(e,t,n){n.d(t,{A:()=>h});var a=n(61163),i=n(859471),r=n(979638),o=n(963522),s=n(586733),l=n(662449),u=n(538329),c=n(337492),p=n(385800),d=n(562615);function h({defaultPillColor:e,hoveredPillColor:t,pressedPillColor:n,viewParameter:h,viewType:m}){(0,i.useEffect)(()=>{(0,a.A)("VisualSearchCancelButton","/app/www/VisualSearch/VisualSearchCancelButton.tsx")},[]);let y=(0,u.A)(),f=(0,r.Zp)(),{id:x}=(0,r.g)(),{active:b,focused:g,hovered:_,onBlur:v,onFocus:w,onMouseDown:M,onMouseEnter:A,onMouseLeave:S,onMouseUp:k}=(0,p.A)(),{pinId:z}=(0,c.A)(x||""),{previous:$}=(0,l.qD)(),{logContextEvent:j}=(0,s.o)();return(0,d.jsx)(o.az,{"data-test-id":"go-back-button",children:(0,d.jsx)(o.Rp,{onBlur:v,onFocus:w,onMouseDown:M,onMouseEnter:A,onMouseLeave:S,onMouseUp:k,onTap:()=>{(j({event_type:101,view_type:m,element:34,view_parameter:h}),0===$.length)?f(z?`/pin/${z}/`:"/",{replace:!0}):f(-1)},tapStyle:"compress",children:(0,d.jsx)(o.az,{dangerouslySetInlineStyle:{__style:{background:b?n:g||_?t:e,backdropFilter:"blur(80px)"}},padding:3,rounding:400,children:(0,d.jsx)(o.In,{accessibilityLabel:y._('Go back', 'imageSearch.cancelButton', 'Cancel button for going back to the Pin page'),color:"default",icon:"close",size:24})})})})}},292815(e,t,n){n.d(t,{A:()=>r});var a=n(859471),i=n(284966);function r({scrollContainerRef:e}){let t=(0,a.useCallback)(t=>{let n=e.current,{buttons:a,clientY:i}=t;if(!n||1!==a||!i)return;let{top:r,bottom:o}=n.getBoundingClientRect(),s=window.innerHeight-r,l=n.scrollHeight,u=Math.max(0,r+20-i),c=Math.max(0,i-(o-20));if(u>0){let e=Math.min(u,100);n.scrollTop-=e}else if(c>0&&!(l<=s)){let e=Math.min(c,100);n.scrollTop+=e}},[e]);return{scrollCropperInView:(0,a.useMemo)(()=>(0,i.A)(t,16),[t])}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/70806-4b9422d8e492b744.mjs.map